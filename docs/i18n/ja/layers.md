# ![](/icons/layer.webp) レイヤー

このメニューにはレイヤースタックが含まれます。これはオブジェクトへの編集内容を非破壊的に保存する方法であり、レイヤーを結合したり再利用したりする多くの手段を提供します。

![](/images/layers_overview.webp) 

## 概要

Nomad のレイヤーは複数の用途を持ちます。

ペイント情報（Color、Roughness、Metalness、Opacity）は、2D ペイントアプリケーションと同様にレイヤーで動作します。レイヤーを作成してモデルにペイントを適用できます。レイヤーはオン/オフの切り替え、透明度の調整、複製、レイヤースタック内での順序変更、ブレンドモードの調整が可能です。

Nomad はスカルプトにもレイヤーを使用します。レイヤーにはシワのような細かいディテールを保存することも、大きな変形を保存することもでき、他の 3D アプリケーションにおけるブレンドシェイプ / シェイプキー / モーフターゲットのように機能させることができます。例えば、異なる表情を別々のレイヤーにスカルプトし、レイヤースライダーを調整してそれらを組み合わせ、新しい表情を作ることができます。

この場合、レイヤーに保存される変更は純粋に加算的であり、ペイントのようにレイヤー順序が問題になることはありません。

レイヤーは [Delete Layer](tools.md#delete-layer) ツールで部分的に消去でき、レイヤーに保存されたさまざまな情報に基づいてマスクを作成することもできます。

![](/videos/layer.mp4)

::: tip
多くのスカルプトソフトウェアとは異なり、メッシュのトポロジーを変更してもレイヤーは破棄されません。[Voxel Remesher](topology.md#voxel-remesher)、[Multiresolution](topology.md#multiresolution)、[Trim](tools.md#trim)/[Split](tools.md#split) ツールを使用できますが、[Voxel Remesher](topology.md#voxel-remesher) を使用した場合はレイヤーの品質に影響が出る点に注意してください。
:::

::: tip
レイヤーをブレンドシェイプ / モーフターゲットとして使用する場合、[シーンメニュー](scene.md#object-menu) に追加のレイヤー機能があります。レイヤーをオブジェクトに分離したり、一致するオブジェクトをレイヤーに結合したりできます。
:::
----

## レイヤーメニュー

![](/images/layers_menu.webp)

`Add layer` を押して新しいレイヤーを作成します。

各レイヤーには名前、強さ/係数を制御するスライダー、オプションボタンがあります。

### オプション

| Action       | Icon                         | Description                                         |
| :----------: | :--------------------------: | :-------------------------------------------------  |
| Visible      | ![](/icons/eye_open.webp)   | レイヤーの表示/非表示を切り替え                    |
| Blend Mode   | ![](/icons/opacity.webp)    | Photoshop 形式のブレンドモード。4 つのアイコンは Color、Roughness、Metalness、Opacity の各モードを表します。 |
| Edit Name    | ![](/icons/pencil.webp)     | レイヤー名を編集                                    |
| Delete       | ![](/icons/trash.webp)      | レイヤーを削除                                      |
| Duplicate    | ![](/icons/clone.webp)      | レイヤーを複製                                      |
| Merge Down   | ![](/icons/merge_down.webp) | レイヤーを下のレイヤー（またはベースメッシュ）と結合 |
| More         | ![](/icons/more.webp)       | [More...](#more) オプション                         |

レイヤーをレイヤースタック内の別の位置に移動するには、その名前を長押ししてドラッグします。

### More...

「More...」ボタンを押すと、現在のレイヤーに対する追加オプションが表示されます。

![](/images/layers_more.webp) 

#### チャンネル係数

これらのコントロールで、そのレイヤーに対する sculpt/color/roughness/metalness/opacity の量をスケーリングできます。これらの値はレイヤーの係数スライダーに乗算されます。例えばレイヤー強度が 1 でも、Color チャンネル係数が 0.5 の場合、表示される色の強さは 0.5 になります。

`Offset` はレイヤーのスカルプト強度を制御します。Color/Roughness/Metalness が 0〜1 の範囲にクランプされるのに対し、Offset は正負を問わず任意の値を取ることができます。 

::: tip
Offset を使うと、バンプのレイヤーをキャビティのレイヤーに変えたり、笑顔をしかめ面に変えたりできます。
![](/videos/layer_happysad.mp4)


対称なレイヤーを複製し、del layer を使って左右のシェイプに分割することもできます。
![](/videos/layer_leftright.mp4)

負の Offset 係数を持つレイヤーを空のレイヤーにベイクして、新しい正のシェイプを作ることができます。

1 を超える正の Offset 係数を持つレイヤーを使って、より極端なブレンドシェイプを試すこともできます。
:::

::: warning
現時点では、レイヤーは 3 つのチャンネル（color/metalness/roughness）すべてで 1 つの Opacity チャンネルのみを共有しています。
チャンネルごとの強度がフルではない複数のレイヤーをマージすると、最終結果が見た目上異なる可能性があります。

将来的には、この制限を取り除くために、各チャンネルが独自のアルファチャンネルを持つようになるかもしれません。
:::


#### ![](/icons/tool_mask.webp) Mask
各スライダーの横にある Mask ボタンは、そのチャンネルからマスクを作成します。ペイントアプリケーションでレイヤーを選択範囲として使うのと同様に、レイヤーで行った作業を他の操作に再利用できます。

#### ![](/icons/preview.webp) Preview
![](/images/layers_preview.webp) 

有効にすると、このレイヤーの抽出設定をプレビューします（次のセクション参照）。

Xray が有効な場合、抽出された形状のみがソリッドになり、残りの形状は透明になります。これは負の抽出高さを使用している場合に便利です。

#### Extract
![](/images/layers_extract.webp) 

![](/videos/layer_shell.mp4)

`Extract` ボタンは、通常は次のセクションで指定した厚みに基づいて、このレイヤーの内容を新しいオブジェクトとして複製します。

`Closing action` は複製の方法を決定します。

* None - 部分を単純に抽出し、側面の生成や穴埋めは行いません。
* Fill - 穴を三角形で埋めてスムーズにします。平面にはこのオプションを使用しないでください。
* Shell - 厚みと方向オプションを使って抽出形状を閉じます。
* Layer - レイヤーの差分を抽出します。

#### ![](/icons/height.webp) Thickness
![](/images/layers_thickness.webp) 

シェル押し出しの深さです。正の値は表面から外側へ、負の値は表面から内側へ成長します。

この値の横にあるプラス/マイナスは押し出し方向を設定します。
* Minus ( - ) は現在の表面から下方向に押し出します。 
* Plus ( + ) は現在の表面から上方向に押し出します。
* PlusMinus ( ± ) は押し出しの上下を等量だけ離すため、元の表面に半分埋め込まれた状態になります。

#### Smoothness
![](/images/layers_smoothness.webp) 

抽出する領域のエッジがギザギザな場合、このスライダーでエッジをぼかして滑らかな形状に近づけます。 

#### ![](/icons/height.webp) Edge loop (side)
![](/images/layers_edgeloop.webp) 

このセクションは Closing action が「Shell」のときに表示されます。 

`Auto Edge-loop (side)` はシェル側面に沿ったエッジループ数を計算し、四角形ポリゴンを生成します。 

無効にした場合、`Division` スライダーで側面の分割数を設定します。

_これで「More...」サブメニューは終了です。_

### Advanced
![](/images/layers_advanced.webp)

#### Keep top layers details

下位レイヤーに大きな変更を加えたときに、上位レイヤーの細かいディテールが見えたままになるようにします。

デフォルトでは、あるレイヤーに細かいシワをスカルプトしてからベースレイヤーに大きな変更を加えると、そのシワは失われます。このトグルを有効にすると、それらの細かいディテールが常に下位の大きな変形の上に浮かぶようになります。次の動画では、デフォルトではシワのディテールが消えてしまうのに対し、「keep top layers details」を有効にすると残り続ける様子が確認できます。

![](/videos/layers_details.mp4)


#### UI: Expand list

デフォルトのレイヤーメニューでは、レイヤーの表示切り替えとレイヤーの透明度のみを操作できます。このオプションを有効にすると、すべてのレイヤーに対してフルコントロールが展開表示されます。

![](/images/layers_expand.webp)

#### Sync transform

有効にすると、選択されていないすべてのレイヤーが、Transform の回転・スケール・スキューに応じて調整されます。 

他のレイヤーを、現在適用している新しい Transform なしで使用したい場合は、このオプションを無効にします。

`Auto` に設定した場合、表示中のレイヤーのみが調整されます。
