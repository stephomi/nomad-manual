# ![](/icons/sun.webp) シェーディング

このメニューでは、Nomad で使用されるシェーディングモード、ライトのプロパティ、環境光／マットキャップのプロパティを制御します。

![](/images/shading_overview.webp)



いくつかのレンダリングモードから選択できます:

| Mode                        | Meaning                    | Description                                                     |
| :-------------------------: | :------------------------: | :-------------------------------------------------------------: |
| [Lit(PBR)](#pbr)            | 物理ベースレンダリング     | メタリック／ラフネスでのペイント                               |
| [Matcap](#matcap)           | マテリアルキャプチャ       | スカルプト時に使用。PBR より GPU/CPU 負荷が低い                |
| [Unlit](#unlit)             | サーフェスカラー           | シェーディングやライティングなしでサーフェスカラーのみ表示     |
| [Object Id](#object-id)      | オブジェクト ID            | オブジェクトごとにランダムな色。ペイントアプリケーションに有用 |
| [Instance Id](#instance-id)  | インスタンス ID            | インスタンスごとにランダムな色。共有メッシュの識別に有用       |

メタリックとラフネスについて詳しく知りたい場合は、[頂点ペイント](painting.md) セクションを参照してください。

---

![](/images/shading_second.webp)

### Face Group
フェイスグループの色をオーバーレイ表示します。フェイスグループはポリゴンの色付き選択で、[Face group](tools#facegroup) ツールで作成でき、多くのプリミティブでは自動的に作成されます。

一部のツールは、フェイスグループが表示されている場合、自動的にフェイスグループでフィルタリングされます。

### Show paint
Nomad はスカルプトの頂点にカラー、ラフネス、メタリックを保存できます。これらのプロパティの表示は、このチェックボックスでグローバルに切り替えられます。

頂点プロパティとテクスチャの両方があり、かつ両方が有効な場合、それらの値は乗算されることに注意してください。

### Show mask
[マスクツール](tools#mask) のグレースケールマスクオーバーレイを切り替えます。これが無効な場合、マスクも無効になります。マスクを失わずに、一時的にマスクなしで素早く編集したいときに便利です。

### Use Hide

非表示フェイスの切り替え。これは「Hide」ツールを使用していないときにのみ機能することに注意してください。

### Use textures

Nomad では [material](material) メニューからオブジェクトにテクスチャを割り当てることができます。テクスチャが割り当てられている場合、このチェックボックスでグローバルに表示を切り替えられます。







### PBR とライトの概要
このマニュアルでは、物理ベースレンダリングの詳細には踏み込みません。

重要な点として、ライティングとマテリアルは完全に分離されています。
つまり、オブジェクトのカラー、ラフネス、メタリックをペイントしつつ、ライティングは独立して扱うことができます。
これにより、モデルの見た目を崩すことなく、後からライティングだけを調整できます。

ライトは [PBR モード](#pbr) でのみ利用可能です。
パフォーマンス上の理由から、ライトは最大 4 つまでに制限されています。

::: tip
4 つ以上のライトを含む glTF ファイルを読み込むことはでき、その場合 Nomad はすべてのライトを保持します。
ただし、パフォーマンスが低下する可能性があります。
:::

::: tip
オブジェクトを Unlit/Emissive にして多数のライトを「偽装」し、そのうえで [ポストプロセス](postprocess) メニューでグローバルイルミネーションを有効にすることもできます。
:::

### ライトタイプの概要

現在サポートされているライトタイプは次のとおりです:

| Mode                        | Description                                             | Can cast shadows                                       |
| :-------------------------: | :-----------------------------------------------------: | :----------------------------------------------------: |
| [Directional](#directional) | 無限遠からの太陽光                                      | yes                                                    |
| [Environment](#environment) | 環境 HDR に合わせられた遠方光                          | yes                                                    |
| [Spot](#spot)               | コーン形状のライト				                        | Yes                                                    |
| [Point](#point)             | 全方向に照射するポイントライト                          | Yes, but only through less robust screen-space shadows |

#### Directional
無限遠から一様な強度で光を放射します。
シーン内での 3D 位置は重要ではなく、向きのみが意味を持ちます。

このライトをカメラにアタッチすることができ、その場合ライティングは常に一定になります。  
例えば、リムライト（モデルの背後からカメラ方向に向けて強い光を当てるライト）として使用すると、常にモデルの背面を照らすことができます。

#### Environment light
[環境 HDR](#environment) を使用すると、全体的なソフトライティングには適していますが、HDR 内に強く鋭い光源がある場合、その光による影は非常にソフトになり、ほとんど見えなくなることがあります。環境 HDR と組み合わせてディレクショナルライトを使用すると改善できますが、両者を正確に揃えるのは難しいことがあります。

このライトはその作業を自動で行います。HDR の中で最も明るい部分に合わせてライトが自動的に回転し、そのうえで強度と角度（影の柔らかさ）を個別に制御できます。 

#### Spot
スポットライトは単一方向に、コーン形状で制限された光を放射します。

#### Point
ポイントライトは全方向に光を放射します。  
現時点では、ポイントライトはシャドウをサポートしていません。

#### Shadows
`normal bias` オプションは、一般的なシャドウアーティファクト（アクネ／ピーターパニング）を軽減するために使用できます。

シャドウの品質は、シーン全体に対するオブジェクトのサイズに依存します。  
影を落とす必要のない大きなオブジェクト（例: 大きな平面）がシーンにある場合、そのオブジェクトの[マテリアル設定](material.md#cast-shadows)でシャドウキャストを無効にしておくとよいでしょう。

## ライト

![](/images/shading_lights.webp)

### ![](/icons/checked.webp) Lights チェックボックス

シーン内のすべての直接光を切り替えます。



### Add light

シーンにライトを追加します（最大 4 つまで）。ライトを追加すると、ライトリストがボタン付きで表示され、ビューポート上部にライトツールバーが追加されます。

![](/images/shading_lights_icons.webp)

* テキストにはライト名と明るさが表示されます。
* 目のアイコンで可視／非表示を切り替えます。
* 鉛筆アイコンでライト名を変更できます。
* ゴミ箱アイコンでライトを削除します。
* コピーアイコンでライトを複製します。 
* 3 点アイコンでフルライトエディタを開きます。この機能の多くは、ビューポートに表示されるツールバーからも利用できます。 

### ![](/icons/spotlight.webp)  Icons

ビューポート内のライトアイコンの表示を切り替えます。

### Light toolbar
![](/images/shading_lights_toolbar.webp) 

ライトが選択されているとき、このツールバーがビューポート上部に表示されます。

* Show でライトの可視性を切り替えます。
* Directional/Environment/Spot/Point でライトタイプを変更します。タップで順送り、長押しでメニュー表示。
* Intensity はライトの強さを制御します。値は 1.0 を超えて設定でき、ポストプロセスのグローバルイルミネーションと組み合わせるときに有用です。
* カラースウォッチをクリックするとカラーピッカーが開きます。Nomad には複数の色選択方法があり、ケルビンコントロールは暖色／寒色の自然な選択に便利です。
* Shadow でシャドウを切り替えます。
* Size はライトの幅を設定します。幅の広いライトは、ソフトな影、柔らかいライティング、そしてオブジェクト上の柔らかいハイライトを生みます。
* ... で追加のコントロールを表示します。

### Light extra controls

![](/images/shading_extra_controls.webp) 

一部のオプションは特定のライトタイプ専用であることに注意してください。

* `Clone` はライトを複製します。
* `Recenter` はライトを原点に戻します。
* `Delete` はライトを削除します。
* `Directional/Environment/Spot/Point` でライトタイプを変更できます。
* `colour swatch` をクリックするとカラーピッカーが開きます。 
* `Intensity` はライトの強さを制御します。
* `Attachment`（ディレクショナルのみ）は、ライトをワールドに親子付けするか、カメラに親子付けするかを設定します。例えばキャラクターの背後にリムライトとしてディレクショナルライトを使用する場合、「camera」を選ぶと、カメラを回転させても常にキャラクターの背後から光が当たります。
* `Angle`（ディレクショナルおよび環境のみ）はライトの見かけの大きさで、空に見える太陽の大きさのようなものです。角度を大きくすると、影はよりソフトになり、ハイライトも広がります。
* `Softness`（スポットライトのみ）はスポットライトコーンのエッジのシャープさを制御します。0 は非常にシャープなエッジ、1 は非常にソフトで、ライトコーン中心に向かってグラデーションになります。ビューポートでは、スポットライトコーン上の小さな青い点をドラッグしてソフトネスをインタラクティブに調整できます。
* `Cone angle`（スポットライトのみ）はスポットライトの広がり角度を制御します。小さい角度は非常に細い光のビーム、170 は非常に広い光の広がりです。ビューポートでは、オレンジの点をドラッグしてコーン角度をインタラクティブに調整できます。
* `Shadow` は現在のライトのシャドウを切り替えます。
* `Shadow map` と `screenspace` はシャドウの計算方法の違いで、一般的には shadow map の方が信頼性があります。
* `Contact` はシャドウの計算方法を調整します。シャドウはコンピュータグラフィックスにおいて難しい問題であり、レンダリングにアーティファクトを引き起こすことがあります。シーン内で最も重要なライトに対して、より正確なシャドウを選択できます。このコントロールは、その「最も重要なライト」を Nomad に自動選択させるか、ユーザーが選択するかを決定します。
* `Tolerance` は、シャドウが接地していないように見えたり、シャドウ内にノイズやパターンが見られる場合などのアーティファクトを調整するためのもので、値を調整することで問題を軽減できます。


## Environment

![](/images/shading_environment.webp)

現実世界の光はあらゆる方向からやってきます。空の青、草の緑、建物の赤など、「環境」からの光は環境マップでシミュレートできます。 

Nomad には、屋内外のさまざまな環境、色味や明るさの異なる複数の環境マップが同梱されています。異なるマップを試して、どれがスカルプトのディテールを最も引き出すか確認してみてください。

画像をタップすると利用可能な環境マップが表示されます。そのダイアログから「Import...」を選択して自分のマップを読み込むこともできます。最適なのは、latlong または equirectangular 形式の HDR 画像（.hdr または .exr）です。[www.polyhaven.com](https://polyhaven.com/hdris) には無料で使える環境マップが多数あり、一般的に 1k の HDR マップがサイズと品質のバランスに優れています。

### Exposure
環境マップの明るさを調整します。通常のライトと併用するとマップが明るすぎる場合があるため、特に [Post Process](postprocess) 設定でグローバルイルミネーションを使用する際には、露出を下げてバランスを取るとよいでしょう。

### Rotation

環境マップは全方向からの光をキャプチャしているため、回転させることで、反射や全体的なライティングをスカルプトとよりよく調和させることができます。

### Attached to camera
環境をカメラにアタッチします。

これによりライティングが常に一定になり、スカルプト中に便利な場合があります。


## ![](/icons/sphere_smooth.webp) Matcap

![](/images/shading_matcap.webp)

名前が示すとおり（MATerial CAPture）、マットキャップは 1 枚の画像の中にライティングとマテリアル情報の両方を含んでいます。
マテリアル自体がマットキャップ内にすでに存在するため、ラフネスとメタリックのペイントチャンネルは無視されます。
ペイントカラーはマットキャップと乗算されるため、黒／グレーのマットキャップを使用している場合、白でペイントしても明るくはなりません。

アーティストは形状やジオメトリそのものに集中できるため、スカルプト用途ではこのモードを好む傾向があります。

球体をタップすると画像ブラウザが開きます。独自のマットキャップを追加することもでき、一般的には任意の写真、レンダー、球体のペイントなどを正方形にきっちりトリミングしたものが利用できます。オンラインには多くのマットキャップライブラリがあり、有用なリソースとして [nidorx matcap library](https://github.com/nidorx/matcaps) があります。

### Use global Matcap

通常、アーティストはスカルプト全体に 1 つのマットキャップを使用しますが、このトグルを無効にすると、オブジェクトごとに別々のマットキャップを設定できます。これは、印象的な表現を得るためのアーティスティックな手法として利用できます。

::: tip
このオプションを無効にして、キャラクターの目に眼球の画像をマットキャップとして使ってみましょう！
:::

### Rotation
マットキャップは特殊な形式の環境マップなので、環境マップと同様に回転させることができます。ビューポート内で 3 本指ドラッグを左右に行うことでも、いつでも回転させられます。



## ![](/icons/circle_fill.webp) Unlit

このモードではサーフェスカラーのみが表示されます。ライト、影、反射、透明度などに惑わされることなく、オブジェクトのサーフェスカラーが意図どおりか確認するのに役立ちます。 

また、このモードはフォトリアルではないフラットでカートゥーン風のレンダリングにも使用できます。

## ![](/icons/cube.webp) Object ID

すべてのライティングおよびサーフェス情報を無視し、各オブジェクトを一意のフラットカラーでシェーディングします。これを PBR レンダーと一緒に出力しておくと、ペイントソフトで色選択を行い、特定のオブジェクトだけ色補正するといった用途に使えます。

これらの色は [Scene メニューのツリービュー](scene#tree-view) にも表示されることに注意してください。

### Randomise id

新しいランダムカラーセットを生成します。 

## ![](/icons/link.webp) Instance ID

Object ID と同様ですが、インスタンスは同じ色になります。 

### Randomise id

新しいランダムカラーセットを生成します。
